"use strict";(self["webpackChunkweek6"]=self["webpackChunkweek6"]||[]).push([[308],{530:function(t,e,o){function i(t){return{all:t=t||new Map,on:function(e,o){var i=t.get(e);i?i.push(o):t.set(e,[o])},off:function(e,o){var i=t.get(e);i&&(o?i.splice(i.indexOf(o)>>>0,1):t.set(e,[]))},emit:function(e,o){var i=t.get(e);i&&i.slice().map((function(t){t(o)})),(i=t.get("*"))&&i.slice().map((function(t){t(e,o)}))}}}o.d(e,{Z:function(){return l}});const a=i();var l=a},308:function(t,e,o){o.r(e),o.d(e,{default:function(){return M}});var i=o(252),a=o(577),l=o(963);const s=(0,i._)("h2",null,"購物車",-1),n={class:"container"},c={class:"table align-middle"},d=(0,i._)("th",null,"圖片",-1),r=(0,i._)("th",null,"商品名稱",-1),u=(0,i._)("th",null,"價格",-1),h=["disabled"],p={style:{width:"200px"}},g={key:0,class:"h5"},m={key:1},b={class:"h6"},v={class:"h5"},_={class:"btn-group btn-group-sm"},f=["onClick","disabled"],C={class:"fas fa-spinner fa-pulse"},k=(0,i.Uk)(" 查看更多 "),w=["onClick","disabled"],I={class:"fas fa-spinner fa-pulse"},y=(0,i.Uk)(" 加到購物車 ");function L(t,e,o,L,$,x){return(0,i.wg)(),(0,i.iD)(i.HY,null,[s,(0,i._)("div",n,[(0,i._)("table",c,[(0,i._)("thead",null,[(0,i._)("tr",null,[d,r,u,(0,i._)("th",null,[(0,i._)("button",{class:"btn btn-outline-secondary",type:"button",onClick:e[0]||(e[0]=t=>x.clearCart()),disabled:!$.cartData.carts?.length>0}," 清空購物車 ",8,h)])])]),(0,i._)("tbody",null,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)($.products,(t=>((0,i.wg)(),(0,i.iD)("tr",{key:t.id},[(0,i._)("td",p,[(0,i._)("div",{style:(0,a.j5)([{backgroundImage:`url(${t.imageUrl})`},{height:"100px","background-size":"cover","background-position":"center"}])},null,4)]),(0,i._)("td",null,(0,a.zw)(t.title),1),(0,i._)("td",null,[t.price===t.origin_price?((0,i.wg)(),(0,i.iD)("div",g,(0,a.zw)(t.price)+" 元 ",1)):((0,i.wg)(),(0,i.iD)("div",m,[(0,i._)("del",b,"原價 "+(0,a.zw)(t.origin_price)+" 元",1),(0,i._)("div",v,"現在只要 "+(0,a.zw)(t.price)+" 元",1)]))]),(0,i._)("td",null,[(0,i._)("div",_,[(0,i._)("button",{type:"button",class:"btn btn-outline-secondary",onClick:e=>x.openProductModal(t.id),disabled:$.isLoadingItem===t.id},[(0,i.wy)((0,i._)("i",C,null,512),[[l.F8,$.isLoadingItem===t.id]]),k],8,f),(0,i._)("button",{type:"button",class:"btn btn-outline-danger",onClick:e=>x.addToCart(t.id),disabled:$.isLoadingItem===t.id},[(0,i.wy)((0,i._)("i",I,null,512),[[l.F8,$.isLoadingItem===t.id]]),y],8,w)])])])))),128))])])])],64)}var $=o(530),x={data(){return{cartData:{},products:[],productId:"",isLoadingItem:""}},methods:{getProduct(){this.$http.get("https://vue3-course-api.hexschool.io/v2/api/ldddl/products/all").then((t=>{console.log("getProduct",t),this.products=t.data.products})).catch((t=>{console.log(t)}))},openProductModal(t){this.productId=t,this.$refs.productModal.openModal()},getCart(){this.$http.get("https://vue3-course-api.hexschool.io/v2/api/ldddl/cart").then((t=>{console.log("getCart",t),this.cartData=t.data.data})).catch((t=>{console.log(t)}))},addToCart(t,e=1){console.log("addToCart");const o={product_id:t,qty:e};this.isLoadingItem=t,this.$http.post("https://vue3-course-api.hexschool.io/v2/api/ldddl/cart",{data:o}).then((t=>{console.log(t),this.getCart(),this.isLoadingItem="",$.Z.emit("get-cart")})).catch((t=>{console.log(t)}))},removeCartItem(t){this.isLoadingItem=t,this.$http.delete(`https://vue3-course-api.hexschool.io/v2/api/ldddl/cart/${t}`).then((t=>{console.log(t),this.getCart(),this.isLoadingItem=""})).catch((t=>{console.log(t)}))},updateCartItem(t){console.log("updateCartItem");const e={product_id:t.id,qty:t.qty};this.isLoadingItem=t.id,this.$http.put(`https://vue3-course-api.hexschool.io/v2/api/ldddl/cart/${t.id}`,{data:e}).then((t=>{console.log(t),this.getCart(),this.isLoadingItem=""})).catch((t=>{console.log(t)}))},clearCart(){console.log("clearCart()"),this.$http.delete("https://vue3-course-api.hexschool.io/v2/api/ldddl/carts").then((t=>{console.log(t),$.Z.emit("get-cart"),this.getCart()})).catch((t=>{console.log(t)}))},pushForm(){this.clearCart(),this.$refs.form.resetForm(),alert("送出表單")}},mounted(){this.getProduct(),this.getCart()}},D=o(744);const z=(0,D.Z)(x,[["render",L]]);var M=z}}]);
//# sourceMappingURL=308.5a7e8db7.js.map